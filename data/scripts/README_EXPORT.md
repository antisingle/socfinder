# üìä –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö SocFinder –≤ Excel

–°–∫—Ä–∏–ø—Ç –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏ —Ç–∞–±–ª–∏—Ü —Å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ –∏–∑ PostgreSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ Excel —Ñ–∞–π–ª.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫
```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–∫—Ä–∏–ø—Ç–æ–≤
cd data/scripts

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–æ—Ä—Ç
./quick_export.sh
```

### 2. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip3 install -r requirements_export.txt

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
python3 export_to_excel.py
```

## üìã –ß—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç Excel —Ñ–∞–π–ª —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ª–∏—Å—Ç–∞–º–∏:

### üìà –õ–∏—Å—Ç "–ü—Ä–æ–µ–∫—Ç—ã"
- –í—Å–µ –ø–æ–ª—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `projects`
- ID, –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ä–µ–≥–∏–æ–Ω, –≥–æ–¥, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –û–ø–∏—Å–∞–Ω–∏–µ, —Ü–µ–ª–∏, –∑–∞–¥–∞—á–∏
- –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- –°—Ç–∞—Ç—É—Å –∏ —Ä–µ–π—Ç–∏–Ω–≥

### üö® –õ–∏—Å—Ç "–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ_–ø—Ä–æ–±–ª–µ–º—ã"
- ID –ø—Ä–æ–±–ª–µ–º—ã –∏ –ø—Ä–æ–µ–∫—Ç–∞
- –¢–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º—ã
- –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞, —Ä–µ–≥–∏–æ–Ω, –≥–æ–¥, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### ‚úÖ –õ–∏—Å—Ç "–†–µ—à–µ–Ω–∏—è"
- ID —Ä–µ—à–µ–Ω–∏—è –∏ –ø—Ä–æ–µ–∫—Ç–∞
- –¢–µ–∫—Å—Ç —Ä–µ—à–µ–Ω–∏—è
- –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞, —Ä–µ–≥–∏–æ–Ω, –≥–æ–¥, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### üìä –õ–∏—Å—Ç "–°–≤–æ–¥–∫–∞_–ø—Ä–æ–±–ª–µ–º_–∏_—Ä–µ—à–µ–Ω–∏–π"
- –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º –∏ —Ä–µ—à–µ–Ω–∏–π
- –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –ø—Ä–æ–±–ª–µ–º –∏ —Ä–µ—à–µ–Ω–∏–π

### üìà –õ–∏—Å—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–æ–≤, –ø—Ä–æ–±–ª–µ–º, —Ä–µ—à–µ–Ω–∏–π
- –î–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞:
- **–•–æ—Å—Ç**: localhost
- **–ü–æ—Ä—Ç**: 5432
- **–ë–∞–∑–∞**: socfinder
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: socfinder_user
- **–ü–∞—Ä–æ–ª—å**: Ant1$1ngleoe

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```python
exporter = ExcelExporter(
    host="your_host",
    port=5432,
    database="your_db",
    user="your_user",
    password="your_password"
)
```

## üìÅ –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

- **–§–æ—Ä–º–∞—Ç**: Excel (.xlsx)
- **–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è**: `exports/`
- **–ò–º—è —Ñ–∞–π–ª–∞**: `socfinder_export_YYYYMMDD_HHMMSS.xlsx`
- **–†–∞–∑–º–µ—Ä**: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.7+
- PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω
- –î–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```
psycopg2-binary==2.9.9  # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
pandas==2.1.4           # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
openpyxl==3.1.2         # –ó–∞–ø–∏—Å—å Excel —Ñ–∞–π–ª–æ–≤
```

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose ps
```

### 2. –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `docker-compose logs postgres`

### 3. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏
- –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç—ã Docker
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç–∞–º–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–µ—Ä–µ–¥ —ç–∫—Å–ø–æ—Ä—Ç–æ–º:
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º –∏ —Ä–µ—à–µ–Ω–∏–π
- –¢–æ–ø —Ä–µ–≥–∏–æ–Ω–æ–≤ –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º

## üîÑ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö —ç–∫—Å–ø–æ—Ä—Ç–æ–≤

### Cron –∑–∞–¥–∞—á–∞ (Linux/Mac)
```bash
# –≠–∫—Å–ø–æ—Ä—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00
0 2 * * * cd /path/to/socfinder/data/scripts && ./quick_export.sh
```

### Windows Task Scheduler
- –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ `quick_export.sh`
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## üìù –õ–æ–≥–∏

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–∞–π–ª `export_to_excel.log`:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø–∏—Å—å –≤ Excel
- –û—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –≠–∫—Å–ø–æ—Ä—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–ª–µ–º
```python
exporter = ExcelExporter()
problems_df = exporter.get_problems_data()
problems_df.to_excel("problems_only.xlsx", index=False)
```

### –≠–∫—Å–ø–æ—Ä—Ç –ø–æ —Ä–µ–≥–∏–æ–Ω—É
```python
# –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å SQL –∑–∞–ø—Ä–æ—Å –≤ get_problems_data()
query = """
    SELECT p.*, pr.name as project_name, pr.region
    FROM problems p
    JOIN projects pr ON p.grant_id = pr.id
    WHERE pr.region = '–ú–æ—Å–∫–≤–∞'
    ORDER BY p.grant_id
"""
```

### –≠–∫—Å–ø–æ—Ä—Ç —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
```python
# –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –≤ –º–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
def get_problems_data(self, region=None, year=None):
    where_clause = ""
    params = []
    
    if region:
        where_clause += " AND pr.region = %s"
        params.append(region)
    
    if year:
        where_clause += " AND pr.year = %s"
        params.append(year)
    
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ SQL –∑–∞–ø—Ä–æ—Å–µ
```
