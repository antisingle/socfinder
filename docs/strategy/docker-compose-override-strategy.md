# Docker Compose Override Strategy –≤ –ø—Ä–æ–µ–∫—Ç–µ SocFinder

## üéØ –û–±–∑–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Docker Compose Override YAML** –ø–æ–¥—Ö–æ–¥ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥ (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- ‚úÖ –ò–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å—Ä–µ–¥–∞–º–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–ø–ª–æ–π

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### 1. **docker-compose.yml** (–±–∞–∑–æ–≤—ã–π)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Å—Ä–µ–¥
- **Git —Å—Ç–∞—Ç—É—Å**: ‚úÖ –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**: –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤, health checks, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### 2. **docker-compose.override.yml** (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **Git —Å—Ç–∞—Ç—É—Å**: ‚ùå –ù–ï –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (.gitignore)
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**: –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞, –ª–æ–∫–∞–ª—å–Ω—ã–µ URL, volumes –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 3. **docker-compose.prod.yml** (–ø—Ä–æ–¥–∞–∫—à–µ–Ω)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- **Git —Å—Ç–∞—Ç—É—Å**: ‚ùå –ù–ï –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (.gitignore)
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**: –ü—Ä–æ–¥–∞–∫—à–µ–Ω URL, —É–±—Ä–∞–Ω–Ω—ã–µ volumes, –ø—Ä–æ–¥–∞–∫—à–µ–Ω –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

---

## üîÑ –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ:
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç override
docker-compose up          # ‚Üí docker-compose.yml + docker-compose.override.yml

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ - —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–¥–∞–∫—à–µ–Ω
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ñ–∞–π–ª–æ–≤:
1. `docker-compose.yml` (–±–∞–∑–æ–≤—ã–π)
2. `docker-compose.override.yml` (–ª–æ–∫–∞–ª—å–Ω—ã–π, –µ—Å–ª–∏ –µ—Å—Ç—å)
3. –Ø–≤–Ω–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `docker-compose.prod.yml`)

---

## üìã –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ

### **docker-compose.yml** (–±–∞–∑–æ–≤—ã–π):
```yaml
services:
  frontend:
    volumes: []  # –ü—É—Å—Ç—ã–µ volumes –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    environment:
      - REACT_APP_API_URL=${REACT_APP_API_URL}
  
  backend:
    environment:
      - DATABASE_URL=${DATABASE_URL}
```

### **docker-compose.override.yml** (–ª–æ–∫–∞–ª—å–Ω–æ):
```yaml
services:
  frontend:
    volumes:
      - ./frontend/src:/app/src      # –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
      - ./frontend/public:/app/public
    environment:
      - REACT_APP_API_URL=http://localhost:8001/api
  
  backend:
    volumes:
      - ./data:/app/data
      - ./backend:/app              # –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

### **docker-compose.prod.yml** (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):
```yaml
services:
  frontend:
    volumes: []  # –£–±—Ä–∞—Ç—å volumes –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
    environment:
      - REACT_APP_API_URL=http://antisingle.fvds.ru:8001/api
  
  backend:
    volumes:
      - ./data:/app/data  # –¢–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ, –Ω–µ –∫–æ–¥
```

---

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç docker-compose.override.yml
docker-compose up -d

# –ò–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å
docker-compose -f docker-compose.yml -f docker-compose.override.yml up -d
```

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω –¥–µ–ø–ª–æ–π:
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ - —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–æ–¥–∞–∫—à–µ–Ω override
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
./deploy.sh
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Ç–æ–≥–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–ª–æ–∫–∞–ª—å–Ω–æ)
docker-compose config

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Ç–æ–≥–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–ø—Ä–æ–¥–∞–∫—à–µ–Ω)
docker-compose -f docker-compose.yml -f docker-compose.prod.yml config
```

---

## üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- **–õ–æ–∫–∞–ª—å–Ω–æ**: `.env.local` (–ù–ï –≤ git)
- **–ü—Ä–æ–¥–∞–∫—à–µ–Ω**: `.env.production` (–ù–ï –≤ git)
- **–®–∞–±–ª–æ–Ω**: `.env.example` (–≤ git)

### –ü–µ—Ä–µ–¥–∞—á–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
export $(cat .env.local | sed '/^#/d')
docker-compose up

# –ü—Ä–æ–¥–∞–∫—à–µ–Ω
docker-compose -f docker-compose.yml -f docker-compose.prod.yml --env-file .env.production up
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ git
2. **–ì–∏–±–∫–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å—Ä–µ–¥–∞–º–∏
3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: Docker Compose —Å–∞–º –≤—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å—Ä–µ–¥—ã (staging, testing)
5. **DRY –ø—Ä–∏–Ω—Ü–∏–ø**: –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
6. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞–µ—Ç —Å CI/CD —Å–∏—Å—Ç–µ–º–∞–º–∏

---

## üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:
- –†–∞–±–æ—Ç–∞—é—Ç –ª–æ–∫–∞–ª—å–Ω–æ —Å `docker-compose up`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- –ù–µ –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –î–ª—è DevOps:
- –î–µ–ø–ª–æ–π—è—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ú–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- –õ–µ–≥–∫–æ –æ—Ç–∫–∞—Ç—ã–≤–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –î–ª—è CI/CD:
- –ú–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–∏ override —Ñ–∞–π–ª—ã
- –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–µ–ø–ª–æ—è

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `docker-compose.yml` - –±–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `docker-compose.override.yml` - –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- `docker-compose.prod.yml` - –ø—Ä–æ–¥–∞–∫—à–µ–Ω –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- `.env.local` - –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `.env.production` - –ø—Ä–æ–¥–∞–∫—à–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `.env.example` - —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- `deploy.sh` - —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–µ–ø–ª–æ—è
- `Makefile` - –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã

---

## üö® –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å** `.env.*` —Ñ–∞–π–ª—ã –≤ git
2. **–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å** override —Ñ–∞–π–ª—ã –≤ git
3. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** `--env-file` –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
4. **–ü—Ä–æ–≤–µ—Ä—è—Ç—å** –∏—Ç–æ–≥–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ `docker-compose config`
5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –ª–æ–∫–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
1. –û–±–Ω–æ–≤–∏—Ç—å `docker-compose.yml`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å override —Ñ–∞–π–ª–∞–º–∏
3. –û–±–Ω–æ–≤–∏—Ç—å `.env.example` –µ—Å–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
5. –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ git

---

*–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Docker Compose –≤ –ø—Ä–æ–µ–∫—Ç–µ SocFinder.*
